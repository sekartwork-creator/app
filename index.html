const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxeI_8mx6kjznc5NuJ1u59dCP2dAFgFwLUUOHr06TjpnlKrfkg2ffMYdV1GvLGxtLEC/exec";

// ดึงรายชื่อพนักงาน
async function loadEmployees() {
  const res = await fetch(SCRIPT_URL + "?action=getEmployees");
  const employees = await res.json();
  const select = document.getElementById("employeeSelect");
  employees.forEach(emp => {
    const option = document.createElement("option");
    option.value = emp.id;
    option.text = emp.id + " - " + emp.name;
    select.appendChild(option);
  });
}

// เช็คชื่อ
async function checkInEmployee() {
  const select = document.getElementById("employeeSelect");
  const staffId = select.value;
  const name = select.options[select.selectedIndex].text.split(" - ").slice(1).join(" -");
  const note = document.getElementById("note").value;
  const resultDiv = document.getElementById("result");

  if (!staffId) {
    resultDiv.textContent = "กรุณาเลือกชื่อก่อน!";
    resultDiv.className = "error";
    return;
  }

  const res = await fetch(`${SCRIPT_URL}?action=checkIn&name=${encodeURIComponent(name)}&staffId=${encodeURIComponent(staffId)}&note=${encodeURIComponent(note)}`);
  const data = await res.json();
  resultDiv.textContent = data.msg;
  resultDiv.className = data.status === "success" ? "success" : "error";
}
